<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Voice Agent - Interface</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!-- CONNECT OVERLAY -->
  <div id="connect-overlay">
    <button class="start-btn" onclick="start()">INITIALIZE SYSTEM</button>
  </div>

  <!-- 1. TRANSCRIPT COL -->
  <div class="col-transcript">
    <div class="col-header">
      <span>Live Transcript</span>
      <div class="live-dot"></div>
    </div>
    <div class="transcript-box" id="transcript"></div>
  </div>

  <!-- 2. CENTER STAGE COL -->
  <div class="col-stage" id="stage">
    <div class="system-status">
      <div class="live-dot" id="status-dot"></div>
      <span id="status-text">SYSTEM STANDBY</span>
    </div>
    <div class="version">V2.0.4-STABLE</div>

    <div class="circle-viz">
      <span class="mic-icon">ðŸŽ¤</span>
    </div>

    <div class="main-text">Voice Processing</div>
    <div class="sub-text" id="ai-hint"></div>

    <div class="waveform-fake">
      <div class="bar" style="animation-delay: 0s"></div>
      <div class="bar" style="animation-delay: 0.1s"></div>
      <div class="bar" style="animation-delay: 0.2s"></div>
      <div class="bar" style="animation-delay: 0.3s"></div>
      <div class="bar" style="animation-delay: 0.2s"></div>
      <div class="bar" style="animation-delay: 0.1s"></div>
      <div class="bar" style="animation-delay: 0s"></div>
    </div>
    <br><br>

    <div style="margin-top:20px; border-top:1px solid #333; padding-top:10px; width: 250px;">
      <details>
        <summary style="cursor:pointer; font-size:12px; color:#888;">Debug: System Context</summary>
        <div style="margin-top:10px; display:flex; gap:10px;">
          <input type="text" id="sysContext" placeholder="New System Prompt..."
            style="flex:1; padding:8px; border-radius:4px; border:none; background:#222; color:#fff;" />
          <button onclick="updateContext()" style="padding:8px; font-size:12px;">Update</button>
        </div>
      </details>
    </div>

    <button id="stop-btn" onclick="stopAI()"
      style="background:transparent; border:1px solid #555; color:#555; padding:5px 10px; cursor:pointer; font-size:10px; margin-top:20px;">STOP
      OUTPUT</button>
  </div>

  <!-- 3. OBSERVABILITY COL -->
  <div class="col-observe">
    <div class="col-header">Real-Time Metrics</div>

    <div class="obs-section">
      <div class="obs-title">Conversation Turn</div>
      <div class="metric-list">

        <div class="metric-item">
          <span class="m-key">VAD Detection</span>
          <span class="m-val" id="m-vad">--</span>
        </div>

        <div class="metric-item">
          <span class="m-key">STT Latency</span>
          <span class="m-val" style="color:var(--cyan)" id="m-stt">0ms</span>
        </div>

        <div class="metric-item">
          <span class="m-key">LLM Latency</span>
          <span class="m-val" style="color:var(--orange)" id="m-llm">0ms</span>
        </div>

        <div class="metric-sub" id="m-ttft">TTFT: 0ms</div>

        <div class="metric-item">
          <span class="m-key">TTS Latency</span>
          <span class="m-val" style="color:var(--red)" id="m-tts">0ms</span>
        </div>

        <div class="metric-item highlight">
          <span class="m-key">Total E2E</span>
          <span class="m-val" id="m-total">0ms</span>
        </div>

      </div>
    </div>

    <div class="obs-section">
      <div class="obs-title">System Health</div>
      <div class="cards-grid">
        <div class="stat-card">
          <div class="stat-label">Noise Floor</div>
          <div class="stat-val">-45dB</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Stability</div>
          <div class="stat-val">Good</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Turn ID</div>
          <div class="stat-val" id="m-turn">0</div>
        </div>
      </div>
    </div>

    <div class="footer-action">
      <button class="term-btn" onclick="terminateSession()">TERMINATE SESSION</button>
    </div>
  </div>

  <script src="audioPlayer.js"></script>
  <script src="config.js"></script>
  <script src="client.js"></script>
</body>

</html>